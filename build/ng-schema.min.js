!function(){"use scrict";function e(e,r,n){function i(i,s,o){var c=o.modelSchema,u=o.formDataPrefix,h=e.get(c),d={};u?d[u]=h:d=h;for(var p=new n(d),b=s[0].querySelectorAll("*[ng-model]"),m=0;m<b.length;m++){var v=f(b[m]),g=angular.element(b[m]).controller("ngModel"),y=v["ng-model"].split(".");y=y[y.length-1];var k=p.paths[v["ng-model"]],x=t(r,k,b[m],i,g),A=angular.element(x).controller("ngModel");for(var w in k)if(k.hasOwnProperty(w)){w=w.toLowerCase();var O=["formatter","parser","validate","trim","uppercase","lowercase","default"];O.indexOf(w)>-1&&a(x,w,k[w],A,i),l(k,i,u,y)}}}var s={restrict:"A",compile:function(){return{post:i}}};return s}function t(e,t,a,n,i){for(var s in t)if(t.hasOwnProperty(s)){s=s.toLowerCase();var o=["select","sparse","index","unique","expires","auto","set","get","virtual","formatter","parser","validate"];-1===o.indexOf(s)&&r(a,s,t[s],i,n)}a.hasAttribute("name")||a.setAttribute("name",a.getAttribute("ng-model"));var c=e(angular.element(a))(n);return c}function a(e,t,a,r){switch(t){case"formatter":r.$formatters.push(a);break;case"parser":r.$parsers.push(a);break;case"validate":i(a,r);break;case"trim":break;case"uppercase":break;case"lowercase":}}function r(e,t,a,r){if(!e.hasAttribute(t))switch(t){case"type":n(e,a);break;case"enum":c(e,t,a,r);break;case"ref":u(e,t,a,r);break;case"required":e.required=!0;break;case"match":s(e,a);break;case"pattern":s(e,a);break;case"minlength":e.setAttribute(t,a);break;case"maxlength":e.setAttribute(t,a);break;case"default":o(e,t,a,r);break;case"minimum":e.setAttribute("min",a);break;case"maximum":e.setAttribute("max",a);break;default:e.setAttribute(t,a)}}function n(e,t){var a;if(["text","number","date","month","time","week","checkbox","radio","email","url","search","password"].indexOf(t)>-1)a=t;else switch(t){case String:a="text";break;case"string":a="text";break;case Number:a="number";break;case"integer":e.setAttribute("step",1),a="number";break;case Date:a="date";break;case Boolean:a="checkbox";break;case d.Types.ObjectId:a="text";break;default:a="text"}e.setAttribute("type",a)}function i(e,t){var a=Object.keys(t.$validators).length;if("function"==typeof e&&(t.$validators["schema-validator"+a]=e),"RegExp"===e.constructor.name){var r=function(e,a){return t.$isEmpty(a)||e.test(a)};t.$validators.validateRegexSchema=r}angular.isArray(e)&&e.forEach(function(r){if(a=Object.keys(t.$validators).length,"function"==typeof r&&(t.$validators["schema-validator"+a]=e),"Object"!==r.constructor.name||!r.validator){var n="Invalid validator. Received ("+typeof r+") "+r;throw new Error(n)}t.$validators["schema-validator"+a]=r.validator})}function s(e,t){var a,r,n;angular.isString(t)?(r=new RegExp(t),a=t):(n=t.toString().match(/^\/(.*)\/([gim]*)$/),n&&(r=t,a=n[1])),e.setAttribute("pattern",a)}function o(e,t,a,r){var n;if(n="function"==typeof a?a():a,e.setAttribute("value",n),"radiobox"===e.type){e.value}if("checkbox"===e.type&&"boolean"==typeof n&&(e.defaultChecked=n),"textarea"===h(e)&&(e.defaultValue=n),"select"===h(e))for(var i=e.options,s=0,o=i.length;o>s;s++)i[s].value===n&&(i[s].selected=!0);r.$setViewValue(n)}function c(e,t,a,r){var n=function(e){var t=a;return t.indexOf(e)>-1};r.$validators.enumValidator=n;var i=h(e);if("select"===i&&0===e.querySelectorAll("option").length&&a.forEach(function(t){var a=document.createElement("option");a.textContent=t,a.setAttribute("value",t),e.appendChild(a)}),"input"===i&&e.hasAttribute("list")===!1){var s=e.getAttribute("ng-model");e.setAttribute("list","list-"+s);var o=document.createElement("datalist");o.setAttribute("id","list"+s),a.forEach(function(e){var t=document.createElement("");t.textContent=e,t.setAttribute("value",e),o.appendChild(t)}),e.insertAdjacentElement("afterEnd",o)}}function u(){}function l(e,t,a,r){var n;if(n=a&&angular.isObject(t[a])?t[a]:t,e.default){var i;i="function"==typeof e.default?e.default():e.default,n[r]=i;{n[r]}}var s={};e.set&&(s.set=e.set),e.get&&(s.get=e.get),e.virtual&&(s.enumerable=!0),(s.set||s.get||s.enumerable)&&angular.isObject(t[a])&&Object.defineProperty(n,r,s)}function f(e){for(var t={},a=e.attributes,r=0;r<a.length;r++){var n=a[r],i=n.nodeName,s=n.value;"class"!==i&&(t[i]=s)}return t}function h(e){var t,a=e.nodeName.toLowerCase();switch(a){case"select":t=a;break;case"textarea":t=a;break;default:t=e.type}return t}function d(e,t){return this instanceof d?(this.paths={},this.nested={},this.tree={},void(e&&this.add(e))):new d(e,t)}angular.module("ng-schema",[]),angular.module("ng-schema").directive("modelSchema",e),angular.module("ng-schema").factory("Schema",function(){return d}),d.Types={},d.Types.ObjectId=String,d.prototype.add=function(e,t){t=t||"";for(var a=Object.keys(e),r=0;r<a.length;++r){var n=a[r];if(null==e[n])throw new Error("Invalid value for schema path `"+t+n+"`");"[object Object]"!==e[n].toString()||e[n].constructor&&"Object"!==e[n].constructor.name||e[n].type&&!e[n].type.type?"Function"!==e[n].constructor.name||"[object Object]"===e[n].toString()||e[n].type?this.path(t+n,e[n]):this.path(t+n,{type:e[n]}):Object.keys(e[n]).length?(this.nested[t+n]=!0,this.add(e[n],t+n+".")):this.path(t+n,e[n])}},d.prototype.path=function(e,t){if(void 0===t){if(this.paths[e])return this.paths[e];if(this.subpaths[e])return this.subpaths[e]}var a=e.split(/\./),r=a.pop(),n=this.tree;return a.forEach(function(t,r){if(n[t]||(n[t]={}),"object"!=typeof n[t]){var i="Cannot set nested path `"+e+"`. Parent path `"+a.slice(0,r).concat([t]).join(".")+"` already set to type "+n[t].name+".";throw new Error(i)}n=n[t]}),n[r]=t,this.paths[e]=t,this},d.prototype.eachPath=function(e){for(var t=Object.keys(this.paths),a=t.length,r=0;a>r;++r)e(t[r],this.paths[t[r]]);return this}}();
